#!/usr/bin/env node

const app = require('../app'); // Import your Express app
const http = require('http');

// If running locally, create a server as usual
if (require.main === module) {
  const port = normalizePort(process.env.PORT || '3000');
  app.set('port', port);

  const server = http.createServer(app);
  server.listen(port, () => {
    console.log(`Server running on port ${port}`);
  });
}

// Export the app for serverless use
module.exports = app;

function normalizePort(val) {
  const port = parseInt(val, 10);
  if (isNaN(port)) {
    return val;
  }
  if (port >= 0) {
    return port;
  }
  return false;
}